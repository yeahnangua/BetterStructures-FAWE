id,priority,phase,area,title,description,acceptance_criteria,test_mcp,review_initial_requirements,review_regression_requirements,dev_state,review_initial_state,review_regression_state,git_state,owner,refs,notes
PIVG-000,P0,1,backend,定位可见性门禁执行点,梳理 NewChunkLoadEvent 到扫描链路中与玩家可见性门禁相关的唯一入口并锁定边界。,可在一个入口函数定位门禁判定且 refs 同时覆盖事件入口与扫描入口；若仓库无该代码需在 notes 标注缺口并给出分支落点引用。,AUTOSERVER,确认本阶段仅做定位不改行为并记录调用链与前置条件。,复核事件优先级与扫描调用关系保持不变且没有新增副作用。,进行中,进行中,未开始,未提交,,plan/2026-02-06_13-44-05-pregen-ignore-visibility-gate.md:16;src/main/java/com/magmaguy/betterstructures/listeners/NewChunkLoadEvent.java:36;src/main/java/com/magmaguy/betterstructures/listeners/NewChunkLoadEvent.java:61;src/main/java/com/magmaguy/betterstructures/listeners/NewChunkLoadEvent.java:100,picked_reason:P0 且为后续门禁改造提供唯一入口边界，先完成可降低后续改动风险
PIVG-010,P0,2,backend,建立预生成状态查询入口,在预生成模型上抽取统一 helper 以复用 activePregenerators 的同世界过滤逻辑并减少重复 stream 代码。,提供可复用的预生成查询入口并满足同世界有活跃任务返回 true 无任务或不同世界返回 false。,AUTOSERVER,检查 helper 命名清晰且仅依赖必要状态并避免重复实现。,回归确认取消或完成预生成后状态查询即时恢复为 false 且不污染其他世界。,未开始,未开始,未开始,未提交,,plan/2026-02-06_13-44-05-pregen-ignore-visibility-gate.md:17;src/main/java/com/magmaguy/betterstructures/util/ChunkPregenerator.java:25;src/main/java/com/magmaguy/betterstructures/util/ChunkPregenerator.java:76;src/main/java/com/magmaguy/betterstructures/commands/CancelPregenerateCommand.java:26,
PIVG-020,P0,3,backend,为可见性门禁加入预生成短路,将可见性门禁收敛为单一判定函数并在外层加入预生成豁免短路避免在预生成期间被新增门禁拦截。,同世界存在 active pregenerator 时直接放行并跳过可见性门禁；无 active pregenerator 时仍执行原门禁判定。,AUTOE2E,审查豁免作用域必须限定同世界且不能绕过其他安全校验。,回归验证常规自然生成仍遵循门禁策略且预生成结束后行为自动恢复。,未开始,未开始,未开始,未提交,,plan/2026-02-06_13-44-05-pregen-ignore-visibility-gate.md:18;src/main/java/com/magmaguy/betterstructures/listeners/NewChunkLoadEvent.java:61;src/main/java/com/magmaguy/betterstructures/util/ChunkPregenerator.java:25;src/main/java/com/magmaguy/betterstructures/commands/CancelPregenerateCommand.java:26,
PIVG-030,P0,4,backend,保持原版结构放置链路不变,仅允许绕过可见性门禁不得改动网格命中 世界白名单 区块 ready 校验 扫描顺序与粘贴链路。,runScanners 扫描顺序保持 surface shallow deep sky liquid dungeon 且 valid world chunk ready 与网格命中逻辑保持一致。,AUTOSERVER,逐项对照现有扫描与前置判断避免顺序变更或条件漂移。,回归覆盖不同结构类型确保放置链路与未改版本一致仅新增门禁豁免差异。,未开始,未开始,未开始,未提交,,plan/2026-02-06_13-44-05-pregen-ignore-visibility-gate.md:19;src/main/java/com/magmaguy/betterstructures/listeners/NewChunkLoadEvent.java:48;src/main/java/com/magmaguy/betterstructures/listeners/NewChunkLoadEvent.java:81;src/main/java/com/magmaguy/betterstructures/listeners/NewChunkLoadEvent.java:100,
PIVG-040,P1,5,backend,补充门禁判定可观测日志,在 debug 或 info 级别区分常规门禁放行 常规拦截 与预生成豁免放行以支持线上排查。,日志至少覆盖三类判定结果并包含世界名与区块坐标且不会在默认配置下造成不可接受刷屏。,AUTOSERVER,审查日志级别 结构化字段 与性能开销并避免泄露敏感信息。,回归验证日志内容可用于定位为什么放置或拦截并确认关闭 debug 时噪声可控。,未开始,未开始,未开始,未提交,,plan/2026-02-06_13-44-05-pregen-ignore-visibility-gate.md:20;src/main/java/com/magmaguy/betterstructures/listeners/NewChunkLoadEvent.java:61;src/main/java/com/magmaguy/betterstructures/util/ChunkPregenerator.java:73,
PIVG-050,P1,6,backend,执行四象限回归矩阵,根据 plan 的四个场景编排脚本与手测矩阵并沉淀可重复执行结果用于会议与回归。,四个场景全部通过并留存结果记录：常规加不可见拦截 常规加可见放置 预生成中加不可见放置 预生成结束后恢复拦截。,AUTOE2E,检查测试前置条件 数据准备 与执行顺序防止结论互相污染。,最终回归需在同一世界重复执行至少一轮并核对取消后状态恢复与无残留任务。,未开始,未开始,未开始,未提交,,plan/2026-02-06_13-44-05-pregen-ignore-visibility-gate.md:21;plan/2026-02-06_13-44-05-pregen-ignore-visibility-gate.md:22;plan/2026-02-06_13-44-05-pregen-ignore-visibility-gate.md:25;src/main/java/com/magmaguy/betterstructures/commands/PregenerateCommand.java:17;src/main/java/com/magmaguy/betterstructures/commands/CancelPregenerateCommand.java:14,
PIVG-060,P1,7,backend,构建与命令链路一致性验证,执行构建并验证 pregenerate 与 cancelPregenerate 命令链路在启动 运行 取消后的状态一致性。,./gradlew build 退出码为 0 且命令链在同世界可启动并取消任务并确认 activePregenerators 无状态残留。,AUTOE2E,审查命令参数边界与错误反馈并确认失败时不会遗留活动任务。,回归执行 pregenerate 到 cancelPregenerate 的往返流程并核对日志与状态集合一致。,未开始,未开始,未开始,未提交,,plan/2026-02-06_13-44-05-pregen-ignore-visibility-gate.md:26;src/main/java/com/magmaguy/betterstructures/commands/PregenerateCommand.java:74;src/main/java/com/magmaguy/betterstructures/commands/PregenerateCommand.java:76;src/main/java/com/magmaguy/betterstructures/commands/CancelPregenerateCommand.java:15;src/main/java/com/magmaguy/betterstructures/util/ChunkPregenerator.java:288,
